<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/html">
<head>
    <meta http-equiv="content-type" content="text/html;charset=UTF-8">
    <meta name="viewport" content="width=device-width,intial-scale=1.0,minimum-scale=1.0">
    <title>Home - Shopme Admin</title>

    <link rel="stylesheet" type="text/css" th:href="@{/webjars/bootstrap/css/bootstrap.min.css}" />
    <link rel="stylesheet" type="text/css" th:href="@{/fontawesome/all.css}"/>
    <script type="text/javascript" th:src="@{/webjars/jquery/jquery.min.js}" > </script>
    <script type="text/javascript" th:src="@{/webjars/bootstrap/js/bootstrap.min.js}" > </script>
    <script src="https://kit.fontawesome.com/e32fe8e1ef.js" crossorigin="anonymous"></script>

    <style>
        .center {
            background-repeat: no-repeat;
            background-size: 100% 100%;
        }
        .right{
            text-align:right;
            margin-left: 10px;
            margin-top: 10px;
            margin-bottom: 10px;
        }
        .left{
            text-align:left;
             margin: 10px;
        }

        .icon-white{
            color: white
        }
        .icon-silver{
            color: silver
        }
        .icon-green{
            color: green
        }
        .icon-dark{
            color: gray
        }
        .icon-red{
            color: red
        }
        .icon-light-green{
            color: springgreen;
        }
        .icon-teal{
            color: teal;
         }
         .center-photo {
            width:25%;
            height:25%;
        }

        .img {
            width: 120px;
            height: auto;
        }
        .widthDiv{
           width:  100;
           height: 100px;
        }
        .box img {
            width: 91px;
            height: 91px;
        }

        .box1 img {
            object-fit: cover;
        }
        .img-logo{
            width:70px;
            height:70px;
        }
        .size-font{
            font-size: 18px;
        }

        @media screen and (max-width: 768px){
            /* small screen */
            div.full-details{
                display: none;
            }
            div.less-details {
                display: block;
            }
        }

        @media screen and (min-width: 768px) and (max-width: 1024px){
            /* medium screen */
            div.full-details{
                display: block;
            }
            div.less-details {
                display: none;
            }
        }

        @media screen and (min-width: 1024px){
            /* large screen */
            div.less-details {
                display: none;
            }
        }

    </style>

</head>
<body>
<div class="container-fluid" style="background-color: #e6ffff">
    <div >
        <nav class="navbar navbar-expand bg-info navbar-dark ">
            <a class="navbar-brand" th:href="@{/}">
<!--                <img th:src="@{/images/ShopmeAdminSmall.png}" />-->
                <img class="img-logo" th:src="@{/images/logo-dark.png}" />
            </a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link text-dark font-weight-bold size-font" th:href="@{/users}">Users</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-dark font-weight-bold size-font" th:href="@{/categories}">Categories</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-dark font-weight-bold size-font" th:href="@{/brands}">Brands</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-dark font-weight-bold size-font" th:href="@{/products}">Products</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-dark font-weight-bold size-font" th:href="@{/customers}">Customers</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-dark font-weight-bold size-font" th:href="@{/shipping}">Shipping</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-dark font-weight-bold size-font" th:href="@{/orders}">Orders</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-dark font-weight-bold size-font" th:href="@{/report}">Sales Report</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-dark font-weight-bold size-font" th:href="@{/articles}">Articles</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-dark font-weight-bold size-font" th:href="@{/menus}">Menus</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-dark font-weight-bold size-font" th:href="@{/settings}">Settings</a>
                    </li>
                </ul>
            </div>

        </nav>
    </div>
    <div>
        <h2>Manage Users</h2>
        <a th:href="@{/users/new}">
            Create New User
            <i class="fas fa-user-plus fa-2x "></i>
        </a>
        &nbsp;|&nbsp;
        <a th:href="@{/users/export/csv}" class="icon-teal" >
            Export to CSV
            <i class="fas fa-file-csv fa-2x "></i>
        </a>
        &nbsp;|&nbsp;
        <a th:href="@{/users/export/excel}" class="icon-green" >
            Export to Excel
            <i class="fas fa-file-excel fa-2x "></i>
        </a>
        &nbsp;|&nbsp;
        <a th:href="@{/users/export/pdf}" class="icon-red" >
            Export to Pdf
            <i class="fas fa-file-pdf fa-2x "></i>
        </a>


    </div>
    <div>


        <div>
            <form th:action="@{/users/page/1}" class="form-inline m-3">
                <input type="hidden" name="sortField" th:value="${sortField}" />
                <input type="hidden" name="sortDir" th:value="${sortDir}" />
                Filter:&nbsp;
                <input type="search" name="keyword" th:value="${keyword}" class="form-control"  required />
                &nbsp;&nbsp;
                <button type="submit" value="Search" class="btn btn-primary" />
                    <i class="fas fa-search"></i>
                </button>
                &nbsp;&nbsp;
                <input type="button" value="Clear" class="btn btn-secondary " onclick="clearFilter()">
            </form>
        </div>
    </div>

    <div th:if="${message != null}" class="alert alert-success text-center">
        [[${message}]]
    </div>

    <div class="full-details">
        <table class="table table-bordered table-striped table-hover table-light  table-responsive-xl">
            <thead class="bg-info">

                    <th>
                        <a class="text-dark" th:if="${sortField!='id'}" th:href="@{  '/users/page/'+${pageNum} +'?sortField=id&sortDir='+${sortDir} + ${keyword != null ?'&keyword='+keyword:'&keyword='+'' }   }">User Id</a>
                        <a class="text-dark" th:if="${sortField=='id'}" th:href="@{  '/users/page/'+${pageNum} +'?sortField=id&sortDir='+${revSortDir} + ${keyword != null ?'&keyword='+keyword:'&keyword='+'' }   }">User Id</a>
                        <span th:if="${sortField=='id'}" th:class="${sortDir =='asc' ? 'fas fa-sort-up' : 'fas fa-sort-down'}"></span>
                    </th>
                    <th>Photo</th>
                    <th>
                        <a class="text-dark" th:if="${sortField!='email'}" th:href="@{  '/users/page/'+${pageNum} +'?sortField=email&sortDir='+${sortDir} + ${keyword != null ?'&keyword='+keyword:'&keyword='+'' }  }">E-mail</a>
                        <a class="text-dark" th:if="${sortField=='email'}" th:href="@{  '/users/page/'+${pageNum} +'?sortField=email&sortDir='+${revSortDir} + ${keyword != null ?'&keyword='+keyword:'&keyword='+'' } }">E-mail</a>
                        <span th:if="${sortField=='email'}" th:class="${sortDir =='asc' ? 'fas fa-sort-up' : 'fas fa-sort-down'}"></span>
                    </th>
                    <th>
                        <a class="text-dark" th:if="${sortField!='firstName'}" th:href="@{  '/users/page/'+${pageNum} +'?sortField=firstName&sortDir='+${sortDir} + ${keyword != null ?'&keyword='+keyword:'&keyword='+'' } }">First Name</a>
                        <a class="text-dark" th:if="${sortField=='firstName'}" th:href="@{  '/users/page/'+${pageNum} +'?sortField=firstName&sortDir='+${revSortDir} + ${keyword != null ?'&keyword='+keyword:'&keyword='+'' } }">First Name</a>
                        <span th:if="${sortField=='firstName'}" th:class="${sortDir =='asc' ? 'fas fa-sort-up' : 'fas fa-sort-down'}"></span>
                    </th>
                    <th>
                        <a class="text-dark" th:if="${sortField!='lastName'}" th:href="@{  '/users/page/'+${pageNum} +'?sortField=lastName&sortDir='+${sortDir} + ${keyword != null ?'&keyword='+keyword:'&keyword='+'' } }">Last Name</a>
                        <a class="text-dark" th:if="${sortField=='lastName'}" th:href="@{  '/users/page/'+${pageNum} +'?sortField=lastName&sortDir='+${revSortDir} + ${keyword != null ?'&keyword='+keyword:'&keyword='+'' } }">Last Name</a>
                        <span th:if="${sortField=='lastName'}" th:class="${sortDir =='asc' ? 'fas fa-sort-up' : 'fas fa-sort-down'}"></span>
                    </th>
                    <th>Roles</th>
                    <th>Enabled</th>
                    <th></th>

            </thead>
            <tbody>
                <tr th:each="user: ${listUsers}">
                    <td>[[${user.id}]]</td>
                    <td>
                        <div  class="box">
                            <div >
                                <span th:if="${user.photos == null}" class="fas fa-portrait fa-6x center icon-dark img " ></span>
                            </div>
                            <div >
                                <img class="box1 img"  th:if="${user.photos != null}" th:src="@{${user.photosImagePath}}" />
                            </div>

                        </div>

                    </td>
                    <td>[[${user.email}]]</td>
                    <td>[[${user.firstName}]]</td>
                    <td>[[${user.lastName}]]</td>
                    <td>[[${user.roles}]]</td>
                    <td>
                        <a th:if="${user.enabled == true}" class="fas fa-check-circle fa-2x icon-green center" th:href="@{'/users/disable/'+${user.id}}" ></a>
                        <a th:if="${user.enabled != true}" class="fas fa-check-circle fa-2x icon-silver center" th:href="@{'/users/enable/'+${user.id}}" id="enable"></a>
                    </td>
                    <td>
                        <a title="Edit this User" class="fas fa-edit fa-2x icon-green left" th:href="@{'/users/edit/'+${user.id}}"></a>

                        <a title="Delete this User" class="fas fa-trash fa-2x icon-dark link-delete right" th:href="@{'/users/delete/'+${user.id}}" th:userId="${user.id}"></a>
                    </td>

                </tr>
            </tbody>
        </table>
    </div>

    <div class="less-details">
        <table class="table table-bordered table-striped table-hover table-light  table-responsive-xl">
            <thead class="bg-info">

            <th>Photo</th>
            <th>Enabled</th>
            <th></th>

            </thead>
            <tbody>
            <tr th:each="user: ${listUsers}">
                <td>
                    <div  class="box">
                        <div >
                            <span th:if="${user.photos == null}" class="fas fa-portrait fa-6x center icon-dark img " ></span>
                        </div>
                        <div >
                            <img class="box1 img"  th:if="${user.photos != null}" th:src="@{${user.photosImagePath}}" />
                        </div>

                    </div>

                </td>

                <td>
                    <a th:if="${user.enabled == true}" class="fas fa-check-circle fa-2x icon-green center" th:href="@{'/users/disable/'+${user.id}}" ></a>
                    <a th:if="${user.enabled != true}" class="fas fa-check-circle fa-2x icon-silver center" th:href="@{'/users/enable/'+${user.id}}" id="enable"></a>
                </td>
                <td>
                    <a title="Edit this User" class="fas fa-edit fa-2x icon-green left" th:href="@{'/users/edit/'+${user.id}}"></a>

                    <a title="Delete this User" class="fas fa-trash fa-2x icon-dark link-delete right" th:href="@{'/users/delete/'+${user.id}}" th:userId="${user.id}"></a>
                </td>

            </tr>
            </tbody>
        </table>
    </div>

    <div class="text-center m-1" th:if="${totalItems > 0}">
        <span>Showing Users from [[${startCount}]] to [[${endCount}]] of [[${totalEle}]]</span>
    </div>
    <div class="text-center m-1" th:if="${totalItems == 0}">
        <span>No users found</span>
    </div>

    <div>
        <nav>
            <ul class="pagination justify-content-center">
                <li class="page-item">
                    <a class="page-link bg-info text-dark font-weight-bold" th:href="@{ '/users/page/1' + '?sortField='+${sortField}+'&sortDir='+${sortDir} +${keyword != null ?'&keyword='+keyword:'&keyword='+'' } }">First</a>
                </li>
                <li>
                    <a th:if="${pageNum == 1}" class="page-link bg-info text-dark font-weight-bold" th:class="${'page-link bg-info text-dark font-weight-bold'}" th:href="@{'/users/page/1' + '?sortField='+${sortField}+'&sortDir='+${sortDir} + ${keyword != null ?'&keyword='+keyword:'&keyword='+'' }  }">Prev</a>
                    <a th:if="${pageNum > 1}" class="page-link bg-info text-dark font-weight-bold" th:href="@{'/users/page/'+${pageNum-1} + '?sortField='+${sortField}+'&sortDir=' +${sortDir} + ${keyword != null ?'&keyword='+keyword:'&keyword='+'' } }">Prev</a>
                </li>

                <li th:class="${pageNum != i ? 'page-item' :'page-item bg-info active' }" class="page-item" th:each="i : ${  #numbers.sequence(1,lastPageNum) }">
                    <a class="page-link text-dark font-weight-bold" th:href="@{'/users/page/'+${i}+ '?sortField='+${sortField}+'&sortDir=' +${sortDir} + ${keyword != null ?'&keyword='+keyword:'&keyword='+'' }      }">[[${i}]]</a>
                </li>

                <li>
                    <a th:if="${pageNum == lastPageNum }" class="page-link bg-info text-dark font-weight-bold" th:href="@{'/users/page/' +${lastPageNum} + '?sortField='+${sortField}+'&sortDir=' +${sortDir} + ${keyword != null ?'&keyword='+keyword:'&keyword='+'' }  }">Next</a>
                    <a th:if="${pageNum != lastPageNum}" class="page-link bg-info text-dark font-weight-bold" th:href="@{'/users/page/'+${pageNum+1} + '?sortField='+${sortField}+'&sortDir=' +${sortDir} + ${keyword != null ?'&keyword='+keyword:'&keyword='+'' }  }">Next</a>
                </li>
                <li class="page-item">
                    <a class="page-link bg-info text-dark font-weight-bold" th:href="@{'/users/page/' +${lastPageNum} +'?sortField='+${sortField}+'&sortDir='+${sortDir} + ${keyword != null ?'&keyword='+keyword:'&keyword='+'' } }">Last</a>
                </li>

            </ul>
        </nav>
    </div>

    <div class="modal fade text-center" id="confirmModal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title" >Delete Confirmation</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body">
                    <span id="modalBody"></span>
                </div>
                <div class="modal-footer">
                    <a class="btn btn-success" href="" id="yesButton">Yes</a>
                    <button type="button" class="btn btn-danger" data-dismiss="modal" >No</button>
                </div>
            </div>
        </div>
    </div>

    <div class="text-center">
        <p>Shopme Control Panel - Copyright &copy; Shopme</p>
    </div>

</div>

<script type="text/javascript">
    $(document).ready(function(){
        $(".link-delete").on("click",function(e) {
            e.preventDefault();
            link = $(this);
            userId = link.attr("userId");
            $("#yesButton").attr("href",link.attr("href"));
            $("#modalBody").text("Are you sure you want to delete this user ID "+userId+"?");
            $("#confirmModal").modal();
        });

    });
    function clearFilter() {
        window.location = "[[@{/users}]]";
    }

</script>
</body>
</html>